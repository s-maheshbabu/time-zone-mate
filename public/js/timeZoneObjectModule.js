var timeZoneObjectModule=angular.module("TimeZoneObjectModule",[]),TimeZoneObject=function(){function TimeZoneObject($interval){this.interval=$interval,this.invalidTime=!1,this.editMode=!1;var timer=null;this._getTimer=function(){return timer},this._setTimer=function(t){timer=t},this.timerManager(!0)}return TimeZoneObject.prototype._updateMoment=function(timePart,datePart){null!=datePart&&(this.moment.year(datePart.getFullYear()),this.moment.month(datePart.getMonth()),this.moment.date(datePart.getDate())),null!=timePart&&(this.moment.hours(timePart.getHours()),this.moment.minutes(timePart.getMinutes()),this.moment.seconds(timePart.getSeconds()),this.moment.milliseconds(timePart.getMilliseconds())),this._timePart=this._getTimePart(),this._datePart=this._getDatePart()},TimeZoneObject.prototype._getTimePart=function(){var m=this.moment;return new Date(m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds())},TimeZoneObject.prototype._getDatePart=function(){var m=this.moment;return new Date(m.year(),m.month(),m.date(),0,0,0)},TimeZoneObject.prototype.timePartGetterSetter=function(value){return angular.isDefined(value)?void(null!=value&&this._updateMoment(value,null)):this._timePart},TimeZoneObject.prototype.datePartGetterSetter=function(value){if(!angular.isDefined(value))return this._datePart;if(null==value)throw"An empty date part should never happen because user can only pick from date picker";this._updateMoment(null,value)},TimeZoneObject.prototype.timerManager=function(flag){var _this=this;flag?(this.interval.cancel(this._getTimer()),this._setTimer(this.interval(function(){_this.moment=_this._getCurrentMoment(),_this._timePart=_this._getTimePart(),_this._datePart=_this._getDatePart()},1e3))):this.interval.cancel(this._getTimer())},TimeZoneObject.prototype.resetMoment=function(){this.moment=this._getCurrentMoment(),this.invalidTime=!1,this.timerManager(!0)},TimeZoneObject.prototype.destroyMoment=function(){this.moment=null,this.invalidTime=!0,this.timerManager(!1),delete this},TimeZoneObject.prototype.markAsInvalid=function(){this.invalidTime=!0},TimeZoneObject.prototype.markAsValid=function(){this.invalidTime=!1},TimeZoneObject.prototype.setEditMode=function(editMode){this.editMode=editMode},TimeZoneObject}();timeZoneObjectModule.factory("NameBasedTimeZoneObject",[function(){return NameBasedTimeZoneObject}]);var NameBasedTimeZoneObject=function($interval,timeZoneName,title){TimeZoneObject.call(this,$interval),this.getMomentInUTC=function(){this._updateMoment(this._timePart,this._datePart);var clone=moment(this.moment);return clone.tz("UTC")},this.setMomentFromUTC=function(inputMoment){var thisTimeZoneMoment=inputMoment.tz(this.timeZoneName);this.interval.cancel(this._getTimer()),this.moment=thisTimeZoneMoment,this._timePart=this._getTimePart(),this._datePart=this._getDatePart()},this._getCurrentMoment=function(){var time=moment();return this.timeZoneName&&time.tz(this.timeZoneName),time},this.title=title,this.timeZoneName=timeZoneName,timeZoneName||(this.title="Local Time",this.timeZoneName=jstz.determine().name()),this.title||(this.title=timeZoneName),this._getTimeZoneName=function(){return timeZoneName},this.moment=this._getCurrentMoment(),this._timePart=this._getTimePart(),this._datePart=this._getDatePart(),this.invalidTime=!1,this.editMode=!1,this.toString=function(){return"Moment: "+this.moment.toString()+". Name: "+this.timeZoneName+". [DatePart: "+this._datePart.toDateString()+"] and [TimePart: "+this._timePart.toTimeString()+"]."}};NameBasedTimeZoneObject.prototype=Object.create(TimeZoneObject.prototype),NameBasedTimeZoneObject.prototype.constructor=NameBasedTimeZoneObject,timeZoneObjectModule.factory("OffsetBasedTimeZoneObject",[function(){return OffsetBasedTimeZoneObject}]);var OffsetBasedTimeZoneObject=function($interval,offsetInMinutes,title){TimeZoneObject.call(this,$interval),this.getMomentInUTC=function(){this._updateMoment(this._timePart,this._datePart);var clone=moment(this.moment);return clone.utcOffset(0)},this.setMomentFromUTC=function(inputMoment){var thisTimeZoneMoment=inputMoment.utcOffset(this.offsetInMinutes);this.interval.cancel(this._getTimer()),this.moment=thisTimeZoneMoment,this._timePart=this._getTimePart(),this._datePart=this._getDatePart()},this._getCurrentMoment=function(){var time=moment().utc();return time.utcOffset(this.offsetInMinutes),time},this.title=title,this.offsetInMinutes=offsetInMinutes,void 0==offsetInMinutes&&(this.title="UTC+0",this.offsetInMinutes=0),this.title||(this.title="UTC+0"),this._getTimeZoneName=function(){return timeZoneName},this.moment=this._getCurrentMoment(offsetInMinutes),this._timePart=this._getTimePart(),this._datePart=this._getDatePart(),this.invalidTime=!1,this.editMode=!1,this.toString=function(){return"Moment: "+this.moment.toString()+". Offset: "+this.offsetInMinutes+". [DatePart: "+this._datePart.toDateString()+"] and [TimePart: "+this._timePart.toTimeString()+"]."}};OffsetBasedTimeZoneObject.prototype=Object.create(TimeZoneObject.prototype),OffsetBasedTimeZoneObject.prototype.constructor=OffsetBasedTimeZoneObject;